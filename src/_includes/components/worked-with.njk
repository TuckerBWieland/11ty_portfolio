<!-- Worked With Section - Clean, Modern Implementation -->
<section class="bg-background-primary py-32" id="worked-with">
    <div class="max-w-content mx-auto px-4 xs:px-5 md:px-11">
        {% from "macros/split-title.njk" import SplitTitle %}
        <!-- Section Title -->
        <div class="mb-16 lg:mb-24">{{ SplitTitle('WORKED', 'WITH') }}</div>

        <!-- Companies Grid -->
        <div class="company-grid mb-12">
            {% for company in companies.companies %}
            <div
                class="company-item"
                data-company="{{ company.name }}"
                data-company-id="{{ company.id }}"
                style="--logo-url: url('{{ company.logo }}');"
            >
                <!-- Single logo with CSS-based color change -->
                <img src="{{ company.logo }}" alt="{{ company.name }} logo" class="company-logo" loading="lazy" />
            </div>
            {% endfor %}
        </div>

        <!-- Tooltip for company details -->
        <div id="company-tooltip" class="company-tooltip">
            <div class="tooltip-arrow"></div>
            <div class="tooltip-content">
                <h3 id="tooltip-company-name" class="tooltip-company-name"></h3>
                <p id="tooltip-company-description" class="tooltip-company-description"></p>
            </div>
        </div>
    </div>
</section>

<!-- Scoped CSS for the component -->
<style>
    /* Company Grid Layout */
    .company-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        justify-items: center;
        align-items: center;
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    /* Desktop: 4 columns with centered incomplete rows */
    /* First 4 items fill first row normally */
    /* Items 5-6 center themselves in the second row */
    .company-item:nth-child(5) {
        grid-column: 2; /* Second column */
    }

    .company-item:nth-child(6) {
        grid-column: 3; /* Third column */
    }

    /* Mobile: 2 columns with centered incomplete rows */
    @media (max-width: 768px) {
        .company-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            max-width: 400px;
        }

        /* Reset desktop positioning */
        .company-item:nth-child(5),
        .company-item:nth-child(6) {
            grid-column: auto;
        }

        /* Center odd item (if any) in the last row */
        .company-item:nth-last-child(1):nth-child(odd) {
            grid-column: 1 / -1;
            justify-self: center;
        }
    }

    @media (max-width: 480px) {
        .company-grid {
            gap: 1rem;
            max-width: 320px;
        }
    }

    /* Company Item Styling */
    .company-item {
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        height: 80px;
        width: 100%;
        max-width: 200px;
    }

    .company-item:hover {
        transform: translateY(-4px) scale(1.05);
    }

    .company-logo {
        height: 80px;
        width: auto;
        max-width: 200px;
        object-fit: contain;
        transition: all 0.3s ease;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        /* Default white SVG fill */
        filter: brightness(0) invert(1);
    }

    /* Gradient overlay on hover - applies rainbow gradient to logo shape */
    .company-item::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 80px;
        max-width: 200px;
        background: linear-gradient(
            90deg,
            #e4c555 0%,
            /* Yellow */ #629fde 16.66%,
            /* Blue */ #27ae60 33.32%,
            /* Green */ #ff3333 49.98%,
            /* Red */ #f45cb3 66.64%,
            /* Pink */ #f87c46 83.3%,
            /* Orange */ #ff6b35 100% /* Orange variant */
        );
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
        z-index: 2;
        /* Use the company logo as a mask for the gradient */
        -webkit-mask-image: var(--logo-url);
        mask-image: var(--logo-url);
        -webkit-mask-size: contain;
        mask-size: contain;
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
        -webkit-mask-position: center;
        mask-position: center;
    }

    .company-item:hover::before {
        opacity: 1;
    }

    .company-item:hover .company-logo {
        /* Hide the white logo when showing gradient version */
        opacity: 0;
    }

    /* Force hover state for click-opened tooltips - use gradient effect */
    .company-item.force-hover::before {
        opacity: 1;
    }

    .company-item.force-hover .company-logo {
        /* Hide the white logo when showing gradient version */
        opacity: 0;
    }

    @media (max-width: 768px) {
        .company-item {
            height: 70px;
            width: 100%;
            max-width: 180px;
        }

        .company-logo {
            height: 70px;
            max-width: 180px;
        }

        .company-item::before {
            height: 70px;
            max-width: 180px;
        }
    }

    @media (max-width: 480px) {
        .company-item {
            height: 60px;
            width: 100%;
            max-width: 140px;
        }

        .company-logo {
            height: 60px;
            max-width: 140px;
        }

        .company-item::before {
            height: 60px;
            max-width: 140px;
        }
    }

    /* Tooltip Styling */
    .company-tooltip {
        position: fixed;
        z-index: 9999;
        background-color: #629fde; /* Blue accent color */
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 8px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        padding: 0;
        max-width: 320px;
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px);
        transition: all 0.3s ease;
        pointer-events: none;
    }

    .company-tooltip.show {
        opacity: 1 !important;
        visibility: visible !important;
        transform: translateY(0) !important;
        pointer-events: auto;
    }

    .tooltip-arrow {
        position: absolute;
        top: -6px;
        left: 50%;
        transform: translateX(-50%);
        width: 12px;
        height: 12px;
        background-color: #629fde;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-bottom: none;
        border-right: none;
        transform: translateX(-50%) rotate(45deg);
    }

    .tooltip-content {
        padding: 16px 20px;
    }

    .tooltip-company-name {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 0.875rem;
        font-weight: 600;
        color: #ffffff;
        margin: 0 0 8px 0;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        line-height: 1.2;
    }

    .tooltip-company-description {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 0.75rem;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.4;
        margin: 0;
    }

    @media (max-width: 640px) {
        .company-tooltip {
            max-width: 280px;
        }

        .tooltip-content {
            padding: 12px 16px;
        }

        .tooltip-company-name {
            font-size: 0.75rem;
        }

        .tooltip-company-description {
            font-size: 0.6875rem;
            line-height: 1.3;
        }
    }

    /* Company items visible by default - no animation */
    .company-item {
        opacity: 1;
        transform: none;
    }
</style>
